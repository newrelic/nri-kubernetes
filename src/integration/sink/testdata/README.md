# Certificates Generation for TLS Tests

## Steps

Install [mkcert](https://formulae.brew.sh/formula/mkcert).

### Generate the Root CA Certificate:

Copy the root CA generated by `mkcert`.

```bash
cd "`mkcert -CAROOT`"
cat rootCA.pem
```

Copy `rootCA.pem` into `src/integration/sink/testdata` replacing the expired cert. Do **NOT** copy `rootCA-key.pem` file.

### Generate the Server Certificate:

In a new terminal window, create a temporary folder and `cd` into it.

```bash
mkcert -cert-file server+3.pem -key-file server+3-key.pem server localhost 127.0.0.1 ::1
```

Copy `server+3.pem` and `server+3-key.pem` into `src/integration/sink/testdata` replacing the expired certs.

### Generate the Client Certificate:

```bash
mkcert -cert-file client-client.pem -key-file client-client-key.pem client
```

Copy `client-client.pem` and `client-client-key.pem` into `src/integration/sink/testdata` replacing the expired certs.

### Run TLS unit tests to confirm certificates work

```bash
go test ./src/integration/sink
```
